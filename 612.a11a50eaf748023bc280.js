(self.webpackChunkwww_covidcast=self.webpackChunkwww_covidcast||[]).push([[612],{1261:(e,t,n)=>{"use strict";n.d(t,{Xc:()=>v,ES:()=>y,x$:()=>T,Cx:()=>O,$C:()=>S,Bo:()=>j,hd:()=>N,Ti:()=>R,t3:()=>x,u_:()=>I});var a=n(3368),i=n(2776),r=n(4584),s=n(1240),o=n(5228),c=n(1853),l=n(1588),h=n(4605),u=n(8758),f=n(4250),m=n(2630);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const v=4;function y(e){return Number.parseInt((0,s.NC)(e),10)}class w{constructor(e,t){this.min=e,this.max=t,this.difference=a.Z.count(e,t),this.range="".concat((0,s.NC)(e),"-").concat((0,s.NC)(t)),this.domain=[e.getTime(),t.getTime()],this.filter=e=>e.date_value>=this.min&&e.date_value<=this.max}toString(){return this.range}static compute(e,t,n,a=c.M1){let i=t(e,n/2);i>a&&(i=a);const r=t(i,-n);return new w(r,i)}}const D=new w((0,s.oy)("20200101"),c.M1),b=3650;class T{constructor(){this.cache=new Map,this.primarySensorKey="",this.primaryRegionId="",this.primaryTimeValue=0,this.primaryWindowRange=""}toDateKey(e,t,n,a=""){const i=this.primarySensorKey===e.key?"SENSOR":e.key,r=this.primaryRegionId===t.id&&"nation"!==t.level?"REGION":"".concat(t.level,"-").concat(t.id),s=this.primaryTimeValue===n.timeValue?"DATE":n.timeValue;return"".concat(i,"@").concat(r,"@").concat(s).concat(a?"@":"").concat(a)}toWindowKey(e,t,n,a=""){const i=this.primarySensorKey===e.key?"SENSOR":e.key,r=this.primaryRegionId===t.id&&"nation"!==t.level?"REGION":"".concat(t.level,"-").concat(t.id),s=this.primaryWindowRange===n.range?"WINDOW":n.range;return"".concat(i,"@").concat(r,"@").concat(s).concat(a?"@":"").concat(a)}invalidate(e,t,n){const a=this.primarySensorKey!==e.key;this.primarySensorKey=e.key;const i=this.primaryRegionId!==t.id;this.primaryRegionId=t.id;const r=this.primaryTimeValue!==n.timeValue;this.primaryTimeValue=n.timeValue;const s=this.primaryWindowRange!==n.windowTimeFrame.range;this.primaryWindowRange=n.windowTimeFrame.range,(a||i||r||s)&&Array.from(this.cache.keys()).forEach((e=>{const t=e.split("@");(a&&"SENSOR"===t[0]||i&&"REGION"===t[1]||r&&"DATE"===t[2]||s&&"WINDOW"===t[2])&&this.cache.delete(e)}))}fetch1SensorNRegions1Date(e,t,n,a){e=e instanceof S?e.value:e,a=a instanceof O?a:new O(a);const i=this.toDateKey(e,{id:n,level:t},a);if(this.cache.has(i))return this.cache.get(i);const r=(0,s.rQ)(e,t,n,a.value,{time_value:a.timeValue},{multiValues:!1,factor:"fraction"===e.format?100:1}).then(s.gg);return this.cache.set(i,r),r}fetch1Sensor1RegionNDates(e,t,n){e=e instanceof S?e.value:e,t=t instanceof R?t.value:t;const a=this.toWindowKey(e,t,n);if(this.cache.has(a))return this.cache.get(a);const i=(0,s.rQ)(e,t.level,t.propertyId,n.range,{geo_value:t.propertyId},{multiValues:!1,factor:"fraction"===e.format?100:1}).then(s.gg).then((t=>(0,s.nT)(t,e)));return this.cache.set(a,i),i}fetchNSensor1RegionNDates(e,t,n){e=e.map((e=>e instanceof S?e.value:e)),t=t instanceof R?t.value:t;const a=e.filter((e=>!this.cache.has(this.toWindowKey(e,t,n))));if(1===new Set(a.map((e=>e.id))).size&&n.range!==D.range){const e=n.difference,i=Math.floor(b/e);for(let e=0;e<a.length;e+=i){const r=a.slice(e,Math.min(a.length,e+i)),o=d(d({},a[0]),{},{signal:r.map((e=>e.signal)).join(",")}),c=(0,s.rQ)(o,t.level,t.propertyId,n.range,{},{multiValues:!1,transferSignal:!0,factor:"fraction"===o.format?100:1}).then(s.gg);for(const e of r){const a=c.then((t=>t.filter((t=>t.signal===e.signal)))).then((t=>(0,s.nT)(t,e)));this.cache.set(this.toWindowKey(e,t,n),a)}}}return e.map((e=>this.fetch1Sensor1RegionNDates(e,t,n)))}fetchNSensorNRegionNDates(e,t,n){if(0===t.length)return Promise.resolve([]);e=e.map((e=>e instanceof S?e.value:e));const a=t[0].level,i=t.map((e=>e.propertyId)).join(","),r=e.filter((e=>!this.cache.has(this.toWindowKey(e,{level:a,id:i},n))));if(1===new Set(r.map((e=>e.id))).size&&n.range!==D.range){const e=n.difference,o=Math.floor(b/e),c=Math.floor(o/t.length),l=Math.floor(o/r.length);if(l>c){const e=[],o=d(d({},r[0]),{},{signal:r.map((e=>e.signal)).join(",")});for(let i=0;i<t.length;i+=l){const r=t.slice(i,Math.min(t.length,i+l));e.push((0,s.rQ)(o,a,r.map((e=>e.propertyId)).join(","),n.range,{},{multiValues:!1,factor:"fraction"===o.format?100:1,transferSignal:!0}))}const c=Promise.all(e).then((e=>e.flat())).then(s.gg);for(const e of r){const t=c.then((t=>t.filter((t=>t.signal===e.signal))));this.cache.set(this.toWindowKey(e,{level:a,id:i},n),t)}}else for(let e=0;e<r.length;e+=c){const t=r.slice(e,Math.min(r.length,e+c)),o=d(d({},r[0]),{},{signal:t.map((e=>e.signal)).join(",")}),l=(0,s.rQ)(o,a,i,n.range,{},{multiValues:!1,transferSignal:!0,factor:"fraction"===o.format?100:1}).then(s.gg);for(const e of t){const t=l.then((t=>t.filter((t=>t.signal===e.signal)))).then((t=>(0,s.nT)(t,e)));this.cache.set(this.toWindowKey(e,{level:a,id:i},n),t)}}}return e.map((e=>this.fetch1SensorNRegionsNDates(e,t,n)))}fetch1SensorNRegionsNDates(e,t,n,a=!1){if(0===t.length)return Promise.resolve([]);e=e instanceof S?e.value:e;const i=t[0].level,r=t.map((e=>e.propertyId)).join(","),o=this.toWindowKey(e,{level:i,id:r},n);if(this.cache.has(o))return this.cache.get(o);const c=n.difference,l=Math.floor(b/c);if(l>=t.length){const r=(0,s.rQ)(e,i,a?"*":t.map((e=>e.propertyId)).join(","),n.range,{},{multiValues:!1,factor:"fraction"===e.format?100:1}).then(s.gg);return this.cache.set(o,r),r}const h=[];for(let a=0;a<t.length;a+=l){const r=t.slice(a,Math.min(t.length,a+l));h.push((0,s.rQ)(e,i,r.map((e=>e.propertyId)).join(","),n.range,{},{multiValues:!1,factor:"fraction"===e.format?100:1}))}const u=Promise.all(h).then((e=>e.flat())).then(s.gg);return this.cache.set(o,u),u}fetchSparkLine(e,t,n){e=e instanceof S?e.value:e,t=t instanceof R?t.value:t,n=n instanceof O?n:new O(n);const a=this.toWindowKey(e,t,n.windowTimeFrame,"sparkline");if(this.cache.has(a))return this.cache.get(a);const i=this.fetch1Sensor1RegionNDates(e,t,n.windowTimeFrame).then((e=>e.filter(n.sparkLineTimeFrame.filter)));return this.cache.set(a,i),i}fetchWindowTrend(e,t,n){e=e instanceof S?e.value:e,t=t instanceof R?t.value:t,n=n instanceof O?n:new O(n);const a=this.toWindowKey(e,t,n.windowTimeFrame,"".concat(n.timeValue,":trend"));if(this.cache.has(a))return this.cache.get(a);const i=this.fetch1Sensor1RegionNDates(e,t,n.windowTimeFrame).then((t=>(0,l.EU)(n.value,t,e.isInverted)));return this.cache.set(a,i),i}fetch1Sensor1Region1DateDetails(e,t,n){e=e instanceof S?e.value:e,t=t instanceof R?t.value:t,n=n instanceof O?n:new O(n);const a=this.toDateKey(e,t,n,"details");if(this.cache.has(a))return this.cache.get(a);const i=(0,s.rQ)(e,t.level,t.propertyId,n.value,{time_value:n.timeValue},{multiValues:!1,advanced:!0,factor:"fraction"===e.format?100:1}).then(s.gg).then((e=>e[0]));return this.cache.set(a,i),i}fetchNSensor1Region1DateDetails(e,t,n){e=e.map((e=>e instanceof S?e.value:e)),t=t instanceof R?t.value:t,n=n instanceof O?n:new O(n);const a=e.filter((e=>!this.cache.has(this.toDateKey(e,t,n,"details"))));if(1===new Set(a.map((e=>e.id))).size){const e=d(d({},a[0]),{},{signal:a.map((e=>e.signal)).join(",")}),i=(0,s.rQ)(e,t.level,t.propertyId,n.value,{},{multiValues:!1,advanced:!0,transferSignal:!0,factor:"fraction"===e.format?100:1}).then(s.gg);for(const e of a){const a=i.then((t=>t.find((t=>t.signal===e.signal))));this.cache.set(this.toDateKey(e,t,n,"details"),a)}}return e.map((e=>this.fetch1Sensor1Region1DateDetails(e,t,n)))}}class O{constructor(e,t,n){this.timeValue=y(e),this.value=e,this.allTimeFrame=D,this.sensorTimeFrame=D;const a=t&&n?n.get(t.key):null;a&&(this.sensorTimeFrame=new w((0,s.oy)(a[0]),(0,s.oy)(a[1]))),this.sparkLineTimeFrame=w.compute(e,i.OM.offset,4,this.sensorTimeFrame.max),this.windowTimeFrame=w.compute(e,r.Z.offset,v,this.sensorTimeFrame.max)}set(e){c.cQ.set((0,s.NC)(e))}}class S{constructor(e){this.key=e.key,this.name=e.name,this.description="function"==typeof e.mapTitleText?e.mapTitleText({}):e.mapTitleText,this.signalTooltip=e.signalTooltip,this.value=e,this.rawValue=e.rawSensor,this.isCasesOrDeath=e.isCasesOrDeath||!1,this.factor="fraction"===e.format?100:1,this.isPercentage="percent"==e.format||"fraction"===e.format,this.isPer100K="per100k"===e.format,this.isInverted=e.isInverted,this.is7DayAverage=e.is7DayAverage,this.valueUnit=this.is7DayAverage?"7-day average":"value",this.formatValue=u.Bw,this.unit=e.unit,this.unitShort=this.isPer100K?"per 100k":this.isPercentage?"per 100":this.unit,this.unitHTML=this.isPer100K?'<span class="per100k"><span>PER</span><span>100K</span></span>':this.isPercentage?'<span class="per100">/100</span>':"",this.xAxis=e.xAxis,this.yAxis=e.yAxis}set(e,t=!1){e&&c.f8.set(e.key),t&&(0,m.k3)()}domain(e,t){const n=(0,h.dU)(e,this.value,t,{},!1),a=[n[0]*this.factor,n[1]*this.factor];return this.isPercentage?(a[0]=Math.max(0,a[0]),a[1]=Math.min(100,a[1])):this.isPer100K&&(a[0]=Math.max(0,a[0]),a[1]=Math.min(1e5,a[1])),a}createColorScale(e,t){const n=this.domain(e,t);return(0,f.ZP)(this.value.colorScale).domain(n)}}const j=new S(c.i7.find((e=>e.isCasesOrDeath&&e.name.includes("Cases")))),N=new S(c.i7.find((e=>e.isCasesOrDeath&&e.name.includes("Deaths"))));class R{constructor(e){e=e||o.MC,this.value=e,this.id=e.id,this.displayName=e.displayName,this.level=e.level,this.propertyId=e.propertyId,this.region=e.region,this.state=e.state}set(e,t=!1){c._M.set(e.propertyId),t&&(0,m.k3)()}}function x(e,t,n){return(0,s.cp)((0,s.nT)(e.filter(t.filter),n),n,t.min,t.max)}function I(e){const t=new Map;for(const n of e){const e=t.get(n.propertyId);e?e.push(n):t.set(n.propertyId,[n])}return t}},1588:(e,t,n)=>{"use strict";n.d(t,{EU:()=>f});var a=n(3368),i=n(8758),r=n(1261);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){const n=(0,r.ES)(e);return t.find((e=>e.time_value===n))}function h(e,t,n,a){const r=function(e,t,n){const a=t-n,i=e-n;return i===a?0:0===a?1:i/a-1}(t.value,e.value,n.value),[s,o,c]=function(e){return e>=.1?["inc","up","Increasing (>= ".concat((0,i.Jv)(.1),")")]:e<=-.1?["dec","down","Decreasing (<= ".concat((0,i.Jv)(-.1),")")]:["steady","steady","Steady (".concat((0,i.Jv)(-.1)," <= v <= ").concat((0,i.Jv)(.1),")")]}(r),l="inc"===s,h="dec"===s;return{trend:o,isIncreasing:l,isSteady:"steady"===s,isDecreasing:h,isBetter:a&&l||!a&&h,isWorse:a&&h||!a&&l,isUnknown:!1,trendReason:c,change:r,delta:t.value-e.value,fractionChange:e.value===t.value?0:0===e.value?1:t.value/e.value-1,ref:e,current:t,refDate:e.date_value,currentDate:t.date_value}}const u={trend:"Unknown",isIncreasing:!1,isSteady:!1,isDecreasing:!1,isUnknown:!0,trendReason:"Unknown",change:Number.NaN,delta:Number.NaN,refDate:new Date,ref:null,min:null,max:null,minDate:null,maxDate:null,worst:null,worstDate:null,best:null,bestDate:null};function f(e,t,n=!1){const{min:i,max:s}=function(e){let t=null,n=null;for(const a of e)null!=a.value&&((!t||t.value>a.value)&&(t=a),(!n||n.value<a.value)&&(n=a));return{min:t,max:n}}(t),c=l(e,t),f=a.Z.offset(e,-7),m=n?i:s,p=n?s:i,d=o(o({},u),{},{refDate:f,min:i,minDate:i?i.date_value:null,max:s,maxDate:s?s.date_value:null,worst:m,worstDate:m?m.date_value:null,best:p,bestDate:p?p.date_value:null});if(!c||null==c.value)return d;d.current=c,d.minTrend=h(i,c,i,n),d.maxTrend=h(s,c,i,n),d.worstTrend=n?d.minTrend:d.maxTrend,d.bestTrend=n?d.maxTrend:d.minTrend;let g=l(f,t);if(!g){const e=(0,r.ES)(g);g=t.reduce(((t,n)=>n.time_value>e||null==n.value?t:!t||t.time_value<n.time_value?n:t),null)}return g?o(o(o({},d),h(g,c,i,n)),{},{ref:g}):d}},1376:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var a=n(5117);function i(e){let t,n,i;return{c(){t=(0,a.bG)("a"),n=(0,a.bG)("span"),n.textContent="Anchor",(0,a.Lj)(n,"class","svelte-12uhg1x"),(0,a.Lj)(t,"href",i="#"+e[4]),(0,a.Lj)(t,"id",e[4]),(0,a.Lj)(t,"class","anchor svelte-12uhg1x")},m(e,i){(0,a.$T)(e,t,i),(0,a.R3)(t,n)},p(e,n){16&n&&i!==(i="#"+e[4])&&(0,a.Lj)(t,"href",i),16&n&&(0,a.Lj)(t,"id",e[4])},d(e){e&&(0,a.og)(t)}}}function r(e){let t,n;return{c(){t=(0,a.bG)("span"),n=(0,a.fL)(e[0]),(0,a.Lj)(t,"class","svelte-12uhg1x")},m(e,i){(0,a.$T)(e,t,i),(0,a.R3)(t,n)},p(e,t){1&t&&(0,a.rT)(n,e[0])},d(e){e&&(0,a.og)(t)}}}function s(e){let t,n,s,o,c=e[4]&&i(e);const l=e[6].default,h=(0,a.nu)(l,e,e[5],null);let u=e[0]&&r(e);return{c(){t=(0,a.bG)("h2"),c&&c.c(),n=(0,a.Dh)(),h&&h.c(),s=(0,a.Dh)(),u&&u.c(),(0,a.Lj)(t,"class","mobile-fancy-header svelte-12uhg1x"),(0,a.VH)(t,"normal",e[1]),(0,a.VH)(t,"center",e[2]),(0,a.VH)(t,"invert",e[3])},m(e,i){(0,a.$T)(e,t,i),c&&c.m(t,null),(0,a.R3)(t,n),h&&h.m(t,null),(0,a.R3)(t,s),u&&u.m(t,null),o=!0},p(e,[s]){e[4]?c?c.p(e,s):(c=i(e),c.c(),c.m(t,n)):c&&(c.d(1),c=null),h&&h.p&&32&s&&(0,a.Tj)(h,l,e,e[5],s,null,null),e[0]?u?u.p(e,s):(u=r(e),u.c(),u.m(t,null)):u&&(u.d(1),u=null),2&s&&(0,a.VH)(t,"normal",e[1]),4&s&&(0,a.VH)(t,"center",e[2]),8&s&&(0,a.VH)(t,"invert",e[3])},i(e){o||((0,a.Ui)(h,e),o=!0)},o(e){(0,a.et)(h,e),o=!1},d(e){e&&(0,a.og)(t),c&&c.d(),h&&h.d(e),u&&u.d()}}}function o(e,t,n){let{$$slots:a={},$$scope:i}=t,{sub:r=null}=t,{normal:s=!1}=t,{center:o=!1}=t,{invert:c=!1}=t,{anchor:l=null}=t;return e.$$set=e=>{"sub"in e&&n(0,r=e.sub),"normal"in e&&n(1,s=e.normal),"center"in e&&n(2,o=e.center),"invert"in e&&n(3,c=e.invert),"anchor"in e&&n(4,l=e.anchor),"$$scope"in e&&n(5,i=e.$$scope)},[r,s,o,c,l,i,a]}class c extends a.f_{constructor(e){super(),(0,a.S1)(this,e,o,s,a.N8,{sub:0,normal:1,center:2,invert:3,anchor:4})}}const l=c}}]);