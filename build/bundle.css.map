{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../../MapBox.svelte"
  ],
  "sourcesContent": [
    "<script>\n  import { onMount, setContext } from \"svelte\";\n  import { selectedRegion, geojsons, currentLevel } from \"./stores.js\";\n  import mapboxgl from \"mapbox-gl\";\n  import * as d3 from \"d3\";\n\n  // https://docs.mapbox.com/help/glossary/access-token/\n  mapboxgl.accessToken =\n    \"pk.eyJ1IjoiYW5kcmV3a3V6bmV0c292IiwiYSI6ImNrOHYwYmEwdzA3bWgzbnE1aGR5d2p1OXcifQ.sSs1i6cqPbX1UOSLsDHD6A\";\n\n  export let lat;\n  export let lon;\n  export let zoom;\n\n  let container;\n  let map;\n\n  currentLevel.subscribe(_ => drawMap());\n\n  function drawMap() {\n    if (map) {\n      d3.json($geojsons.get($currentLevel)).then(data => {\n        data.features.forEach(d => (d.properties.val = Math.random()));\n        console.log(data);\n        map.getSource(\"map\").setData(data);\n      });\n    }\n  }\n\n  onMount(() => {\n    const link = document.createElement(\"link\");\n    link.rel = \"stylesheet\";\n    link.href = \"https://unpkg.com/mapbox-gl/dist/mapbox-gl.css\";\n\n    link.onload = () => {\n      map = new mapboxgl.Map({\n        container,\n        style: \"mapbox://styles/mapbox/streets-v9\",\n        center: [lon, lat],\n        zoom\n      });\n\n      map.on(\"load\", function() {\n        d3.json($geojsons.get($currentLevel)).then(data => {\n          data.features.forEach(d => (d.properties.val = Math.random()));\n          map.addSource(\"map\", {\n            type: \"geojson\",\n            data: data\n          });\n          map.addLayer({\n            id: \"map\",\n            source: \"map\",\n            type: \"fill\",\n            layout: {},\n            paint: {\n              \"fill-color\": {\n                property: \"val\",\n                stops: [[0, \"#fff\"], [1, \"#f00\"]]\n              },\n              \"fill-opacity\": [\n                \"case\",\n                [\"boolean\", [\"feature-state\", \"hover\"], false],\n                1,\n                0.5\n              ]\n            }\n          });\n          map.on(\"click\", \"map\", function(e) {\n            selectedRegion.set(e.features[0].properties.NAME);\n            new mapboxgl.Popup()\n              .setLngLat(e.lngLat)\n              .setHTML(e.features[0].properties.NAME)\n              .addTo(map);\n          });\n        });\n      });\n    };\n\n    document.head.appendChild(link);\n\n    return () => {\n      map.remove();\n      link.parentNode.removeChild(link);\n    };\n  });\n</script>\n\n<style>\n  div {\n    width: 100%;\n    height: 600px;\n  }\n</style>\n\n<div bind:this={container} />\n"
  ],
  "names": [],
  "mappings": "AAwFE,GAAG,cAAC,CAAC,AACH,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,KAAK,AACf,CAAC"
}